/**
 * Ctrip JavaScript Code
 * http://www.ctrip.com/
 * Copyright(C) 2008 - 2015, Ctrip All rights reserved.
 * Version: 150227
 * Date: 2015-02-27
 */
;window.replace=function(){return ''};(function(k){var e={_cache_:{},VERSION:"1.0.2",DKEY:"yyyy-mm",MASK:"yyyy-mm-dd",log:function(a){e._cache_.logs||(e._cache_.logs=[]);if(!a)return e._cache_.logs;e._cache_.logs.push(a)},pad:function(a,b){a+="";for(b=b||2;a.length<b;)a="0"+a;return a},format:function(a,b){b=b||this.MASK;var c=a.getDate(),d=e.pad;a.getDay();var g=a.getMonth(),h=a.getFullYear(),f=a.getHours(),l=a.getMinutes(),m=a.getSeconds(),k=a.getTime(),n={d:c,dd:d(c),m:g+1,mm:d(g+1),yy:String(h).slice(2),yyyy:h,H:f,M:l,S:m,L:d(k,3)};
return b.replace((/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|"[^"]*"|'[^']*'/g),function(a){return (a in n?n[a]:a.slice(1,a.length-1))})},parseDateInt:function(a){"string"==typeof a&&(a=a.toDate());return (a?parseInt(e.format(a,"yyyymmdd"),10):!1)},addMonth:function(a,b){return new Date(a.getFullYear(),a.getMonth()+b,1)},get:function(a){if(!a)return e.log("Date is null, Can't create calendar data structure."),null;var b=e.format(a,"yyyy-mm");e._cache_[b]||e._create(a,b);return e._cache_[b]},_create:function(a,
b){var c=a.getFullYear(),d=a.getMonth();a.getDay();a.getDate();var g=(new Date(c,d,1)).getDay()-1;(new Date(c,d+1,0)).getDate();for(var h=[],f=0;42>f;f++){var l=new Date(c,d,f-g),m=e.format(l,"yyyy-mm-dd"),l={o:l,k:m,i:parseInt(m.replace((/-/gi),""),10),y:l.getFullYear(),m:l.getMonth(),d:l.getDate(),w:l.getDay()};h.push(l)}return e._cache_[b]=h}},n=new Date,q=null,p=function(a,b){this.setting={options:{container:k.container,reference:!1,step:2,offset:{},minDate:"#",maxDate:null,startDate:null,endDate:null,
permit:null,prohibit:null,weekday:"0123456",render:"default",showAlways:!1,showOptions:!1,showWeek:!0,nextEl:null,rangeColor:"#c3daf7",hoverColor:"#d9e5f4",defaultDate:null,date:null,tipText:"yyyy-mm-dd",zindex:9999},string:{header:"\u8bf7\u9009\u62e9\u65e5\u671f",title:"yyyy\u5e74m\u6708",week:"\u661f\u671f\u65e5 \u661f\u671f\u4e00 \u661f\u671f\u4e8c \u661f\u671f\u4e09 \u661f\u671f\u56db \u661f\u671f\u4e94 \u661f\u671f\u516d".split(" "),weekText:"pic_sun pic_mon pic_tue pic_wed pic_thu pic_fir pic_sat".split(" "),
todayText:["pic_today","pic_tomorrow","pic_aftertomorrow"]},classNames:{select:"day_selected",nothismonth:"day_over",blankdate:"day_no",today:"today",tomorrow:"",aftertomorrow:""},listeners:{onBeforeShow:null,onShow:null,onChange:null},template:{wrapper:'<div class="calendar_wrap">\n<div class="calendar_content" id="${uid}"></div>\n<a class="month_prev" href="javascript:void(0);" data-bind="prev"></a>\n<a class="month_next" href="javascript:void(0);" data-bind="next"></a>\n</div>',calendar:'<div class="calendar_month${monthclass}">\n<div class="calendar_title">${title}</div>\n<dl class="calendar_day">\n<dt class="weekend">\u65e5</dt><dt>\u4e00</dt><dt>\u4e8c</dt><dt>\u4e09</dt><dt>\u56db</dt><dt>\u4e94</dt><dt class="weekend">\u516d</dt>\n<dd>\n{{each data}}\n{{if isfestival}}<a href="javascript:void(0);" ${classes}><span class="c_day_festival" ${attr}>${day}</span>{{else}}<a href="javascript:void(0);" ${classes} ${attr}>${day}{{/if}}</a>\n{{/each}}\n</dd>\n</dl>\n</div>',
styles:"\n.calendar_wrap{position:relative;display:inline-block;padding:3px 5px 0;font-size:12px;font-family:tahoma,\u200bArial,\u200bHelvetica,\u200bsimsun,\u200bsans-serif;border:1px solid #999;background:#fff;*display:inline;*zoom:1;box-shadow:0 3px 5px #ccc;}.calendar_content{background:#bbb;}.calendar_month{float:left;overflow:hidden;width:182px;text-align:center;}.calendar_title{height:23px;line-height:23px;font-weight:bold;color:#fff;text-align:center;background-color:#004fb8;}.month_next,.month_prev{position:absolute;top:3px;width:23px;height:23px;color:#fff;background:#2d7ce7 url(http://pic.c-ctrip.com/cquery/un_calender_index.png) no-repeat;cursor:pointer;cursor:pointer;}.month_prev{left:5px;}.month_next{right:5px;float:right;background-position:100% 0;}.month_prev:hover{background-color:#62adf1;background-position:0 -26px;}.month_next:hover{background-color:#62adf1;background-position:100% -26px;}.calendar_day{overflow:hidden;padding-top:4px;padding-bottom:5px;}.calendar_day dt{display:inline;float:left;width:26px;height:22px;line-height:20px;color:#666;border-bottom:2px solid #fff;background:#ececec;}.calendar_day .weekend{font-weight:bold;color:#f90;}.calendar_day dd{_width:185px;}.calendar_day dd a{float:left;overflow:hidden;width:26px;height:24px;line-height:22px;border:1px solid #fff;border-width:1px 0;font-size:11px;font-weight:bold;color:#005ead;text-decoration:none;cursor:pointer;}.calendar_day a:hover,.calendar_day .today,.calendar_day .day_selected,.calendar_day .c_festival_select,.calendar_day .c_festival_select:hover{background:#e6f4ff url(http://pic.c-ctrip.com/cquery/un_calender_index.png) no-repeat;}.calendar_day a:hover{background-color:#e6f4ff;background-position:-26px -53px;text-decoration:none;}.calendar_day .today{background-color:#fff5d1;background-position:0 -82px;}.calendar_day .day_over,.calendar_day .day_no{font-weight:normal;color:#dbdbdb;outline:none;cursor:default;}.calendar_day .day_over:hover,.calendar_day .day_no:hover{background:#fff;}.calendar_day .day_selected,.calendar_day .day_selected:hover{background-color:#629be0;background-position:0 -53px;color:#fff;}.calendar_day .c_festival_select,.calendar_day .c_festival_select:hover{background-color:#ffe6a6;background-image:url(http://pic.c-ctrip.com/cquery/un_calender_index.png);background-position:0 -111px;}.calendar_month.other{width:192px;}.calendar_month.other .calendar_day{margin-left:4px;padding-left:4px;border-left:2px solid #bbb;}.calendar_day .c_festival_select,.calendar_day .c_festival_select:hover{background-color:#ffe6a6;background-image:url(http://pic.c-ctrip.com/cquery/un_calender_index.png);background-position:0 -111px;}.c_yuandan span,.c_chuxi span,.c_chunjie span,.c_yuanxiao span,.c_qingming span,.c_wuyi span,.c_duanwu span,.c_zhongqiu span,.c_guoqing span,.c_jintian span,.c_shengdan span{width:24px;height:24px;background-image:url(http://pic.c-ctrip.com/cquery/un_festivals.png?v=1);background-repeat:no-repeat;text-indent:-9999em;overflow:hidden;display:block;}.c_yuandan span{background-position:0 0;}.c_chuxi span{background-position:0 -32px;}.c_chunjie span{background-position:0 -64px;}.c_yuanxiao span{background-position:0 -96px;}.c_qingming span{background-position:0 -128px;}.c_wuyi span{background-position:0 -160px;}.c_duanwu span{background-position:0 -192px;}.c_zhongqiu span{background-position:0 -224px;}.c_guoqing span{background-position:0 -256px;}.c_jintian span{background-position:0 -288px;}.c_shengdan span{ background-position: 0 -320px;}.c_calender_date{display:inline-block;color:#666;text-align:right;position:absolute;z-index:1;}.calendar_wrap:before,.calendar_wrap:after{content:'.';display:block;overflow:hidden;visibility:hidden;font-size:0;line-height:0;width:0;height:0;}.calendar_wrap:after{clear:both;}\n"},
festival:{"2015-02-18":["c_chuxi","\u9664\u5915"],"2014-01-30":["c_chuxi","\u9664\u5915"],"2013-02-09":["c_chuxi","\u9664\u5915"],"2015-02-19":["c_chunjie","\u6625\u8282"],"2014-01-31":["c_chunjie","\u6625\u8282"],"2013-02-10":["c_chunjie","\u6625\u8282"],"2015-03-05":["c_yuanxiao","\u5143\u5bb5"],"2014-02-14":["c_yuanxiao","\u5143\u5bb5"],"2013-02-24":["c_yuanxiao","\u5143\u5bb5"],"2015-04-05":["c_qingming","\u6e05\u660e"],"2014-04-05":["c_qingming","\u6e05\u660e"],"2013-04-04":["c_qingming","\u6e05\u660e"],
"2015-06-20":["c_duanwu","\u7aef\u5348"],"2014-06-02":["c_duanwu","\u7aef\u5348"],"2013-06-12":["c_duanwu","\u7aef\u5348"],"2015-09-27":["c_zhongqiu","\u4e2d\u79cb"],"2014-09-08":["c_zhongqiu","\u4e2d\u79cb"],"2013-09-19":["c_zhongqiu","\u4e2d\u79cb"],"01-01":["c_yuandan","\u5143\u65e6"],"05-01":["c_wuyi","\u52b3\u52a8"],"10-01":["c_guoqing","\u56fd\u5e86"],"12-25":["c_shengdan","\u5723\u8bde"]}};var c=this;c.target=k(a);if(b&&(k.extend(!0,this.setting,b),b.options&&b.options.date)){var d=b.options.date.toDate();
d&&(n=d)}q=e.parseDateInt(n);c.uid="calendar"+c.target.uid();this._fragment=document.createDocumentFragment();var g=!1;(this.setting.options.showAlways?(g||(c._init(),g=!0),c.show(),this._isShow=!1):(c.target.bind("focus",function(){g||(c._init(),g=!0);c.show()}),c.target.bind("mousedown",function(a){g||(c._init(),g=!0);c.show()})))};p.prototype={_init:function(){var a=this.setting.options;this.container=k(a.container);this.step=1*(a.step||1);this.setMinDate(a.minDate);a.maxDate&&(a.maxDate=a.maxDate.toDate(),
this._max=e.parseDateInt(a.maxDate));a.starDate&&(this._start=e.parseDateInt(a.startDate));a.endDate&&(this._end=e.parseDateInt(a.endDate));a.reference&&(this.reference=k(a.reference));this._initTpl()},_initTpl:function(){var a=this.uid,b=this.setting.template,c=this.setting.options,d='<hr style="display:none;line-height:0;font-size:0;border:none;" /><style>'+b.styles.replace((/(\s*)([^\{\}]+)\{/g),function(b,c,d){return c+d.replace((/([^,]+)/g),"#"+a+" $1")+"{"})+"</style>",g=document.createElement("div");
g.id=a;g.style.cssText="width:"+195*c.step+"px;z-Index:"+this.setting.options.zindex+";";g=k(g);g.html(d+k.tmpl.render(b.wrapper,{uid:"c_"+a}));this._layout=g;this._content=g.find("#c_"+a);var e=this,f=!0;g.bind("mousedown",function(a){var b=a.target||a.srcElement;e._handleEvent(b);f=!1;"select"!=b.nodeName.toLowerCase()&&a.stop()});c.showAlways||(k(document).bind("click",function(a){e._checkExternalClick(a);f=!0}),this.target.bind("blur",function(){f&&e.hide()}),g.bind("mouseup",function(a){f=!0}));
this.reference&&(e._tempEnd=!1,g.bind("mousemove",function(a){(e.isIn(e._content[0],a.target)?e._checkHoverColor(a.target):e._tempEnd&&(e._tempEnd=!1,e.update()))}))},setMinDate:function(a){if(a){if("#"==a)this.setting.options.minDate=n,b=q;else{a=a.toDate();var b=!1;a&&(this.setting.options.minDate=a,b=e.parseDateInt(a))}this._min=b}else this._min=!1},isIn:function(a,b){for(var c=b;c&&9!==c.nodeType;){if(c==a)return!0;c=c.parentNode}return!1},_checkExternalClick:function(a){a=a.target||a.srcElement;
k(a);var b=this.uid;if(!this.isIn(this._layout[0],a)&&a!=this.target[0]&&a.id!=b){if("OPTION"==a.nodeName||"#document"==a.nodeName)return!1;this.hide()}},_handleEvent:function(a){var b=a.getAttribute("data-bind");if(b)switch(b){case "close":this.hide();break;case "prev":this.changeDrawMonth(-this.step);break;case "next":this.changeDrawMonth(this.step);break;case "select":this.select(a)}return!1},changeDrawMonth:function(a){this._drawDate=e.addMonth(this._drawDate,a);this.update()},show:function(){var a=
this.setting.options;if(!this._isShow){p.__inst&&p.__inst.uid!=this.uid&&p.__inst.hide();this._updateOptions();var b=this.setting.listeners;b.onBerforeShow&&b.onBerforeShow.call(this);this.update();this.container.append(this._layout);a.showAlways||(this._layout.offset(this.target,this.setting.options.offset),p.__inst=this);b.onShow&&b.onShow.call(this);this.setting.options.showAlways||this._layout.cover();this._isShow=!0}},hide:function(){this._isShow&&(this.setting.options.showAlways||this._layout.uncover(),
this._fragment.appendChild(this._layout[0]),this._isShow=!1)},_updateOptions:function(){var a=this.target.data(),b=this.setting.options,c;for(c in a)switch(c){case "startDate":var d=e.parseDateInt(a.startDate);d!=this._start&&(b.startDate=a.startDate,this._start=d);break;case "endDate":d=e.parseDateInt(a.endDate);d!=this._end&&(b.endDate=a.endDate,this._end=d);break;case "minDate":a.minDate=a.minDate.toDate();(d=a.minDate)&&d!=b.minDate&&(b.minDate=d,this.setMinDate(d));break;case "maxDate":a.maxDate=
a.maxDate.toDate();(d=e.parseDateInt(a.maxDate))&&d!=this._max&&(b.maxDate=a.maxDate,this._max=d);break;case "showWeek":b.showWeek=a.showWeek;break;case "permit":b.permit=a.permit;break;case "prohibit":b.prohibit=a.prohibit;break;case "weekday":b.weekday=a.weekday;break;case "reference":this.reference=k(a.reference);break;case "nextEl":b.nextEl=a.nextEl}this.reference&&(this._tempEnd=!1,a=this.reference.value().toDate())&&(this.setting.options.startDate=a,this._start=e.parseDateInt(a));this.setCurrentDate(this.target);
this._start&&this.currentDate&&(b.endDate=this.currentDate,this._end=this.currentDint);this._parseDrawMonth()},_parseDrawMonth:function(){var a=!1,b=this.setting.options;(this.currentDate?this._drawDate=this.currentDate:((b.defaultDate?a=b.defaultDate.toDate():this._min&&(a=b.minDate)),a||(a=n),this._drawDate=a))},setCurrentDate:function(a){a=a.value();a.isDate()&&(a=a.toDate(),this.isPassDate(a)||(this.currentDate=a,this.currentDint=e.parseDateInt(a)))},setDate:function(a,b){a.isDate()&&(n=a.toDate(),
q=e.parseDateInt(n),this.setting.options.showWeek&&this.setWeek(b))},update:function(){var a=this.step,b=1,c=this._create(this._drawDate);if(a>b)for(;b<a;b++)c+=this._create(e.addMonth(this._drawDate,b),"other");this._content.html(c);if(this.setting.options.showOptions){var d=this._layout.find("select"),g=this;d.bind("change",function(){g._drawDate=new Date(d[0].value,1*d[1].value-1,1);g.update()})}},_create:function(a,b){var c=this.setting,d=c.options,g=a.getMonth(),h=c.template,f="",l=this._renderCalendar(a);
if(d.showOptions){for(var c=g+1,g=a.getFullYear(),m=(d.minDate?d.minDate.getFullYear():1900),d=(d.maxDate?d.maxDate.getFullYear():2020),f='<select name="year">';m<=d;m++)f=(m==g?f+('<option value="'+m+'" selected="selected">'+m+"</options>"):f+('<option value="'+m+'">'+m+"</options>"));f+='</select>\u5e74 <select name="m">';for(d=1;13>d;d++)f=(d==c?f+('<option value="'+d+'" selected="selected">'+d+"</options>"):f+('<option value="'+d+'">'+d+"</options>"));f+="</select>\u6708"}else f=e.format(a,c.string.title);
return k.tmpl.render(h.calendar,{title:f,monthclass:(b?" "+b:""),data:l})},_renderCalendar:function(a){var b=e.get(a),c=a.getMonth(),d=this;a=0;for(var g=[],h=this.setting.classNames,f={"default":function(a){return (a.m==c?d._parseCellDate(a,h,c):{day:"",date:null,classes:' class="'+h.blankdate+'"'})},all:function(a){return d._parseCellDate(a,h,c)}}[this.setting.options.render];42>a;a++)g.push(f(b[a]));return g},_checkFestival:function(a){var b=a.substring(5),c=this.setting.festival;return (c[a]?c[a]:
(c[b]?c[b]:!1))},_parseCellDate:function(a,b,c){var d=a.k;c=a.i;var e=a.w,h=' id="'+d+'"',f=[];a={day:a.d,date:d,classes:"",attr:""};c==q&&f.push(b.today);if(this._checkPassDate(d,c,e))f.push(b.nothismonth);else{h+=' data-bind="select"';if(d=this._checkFestival(d))a.isfestival=!0,f.push(d[0]);this.currentDate&&this.currentDint==c&&((a.isfestival?f.push("c_festival_select"):f.push(b.select)));this._start&&(this._start==c&&((a.isfestival?f.push("c_festival_select"):f.push(b.select))),this._end&&c>this._start&&
c<this._end&&(h+=' style="background-color: '+this.setting.options.rangeColor+'"'),this._tempEnd&&c>Math.max(this._start,this._end||0)&&c<this._tempEnd&&(h+=' style="background-color: '+this.setting.options.hoverColor+'"'))}0<f.length&&(a.classes=' class="'+f.join(" ")+'"');a.attr=h;return a},isPassDate:function(a){var b=e.format(a),c=e.parseDateInt(a);a=a.getDay();return this._checkPassDate(b,c,a)},_checkPassDate:function(a,b,c){var d=this.setting.options;return (d.prohibit&&-1!==d.prohibit.indexOf(a)?
!0:(d.permit&&-1!==d.permit.indexOf(a)?!1:(this._min&&b<this._min||this._max&&b>this._max||-1===d.weekday.indexOf(c)?!0:!1)))},_checkHoverColor:function(a){if("select"==a.getAttribute("data-bind")){var b=0;((a=a.id)?(a=e.parseDateInt(a))&&a>Math.max(this._start,this._end||0)&&(b=a):b=0);this._tempEnd!=b&&(this._tempEnd=b,this.update())}},select:function(a){a=a.id;var b=a.toDate(),c=this.target[0],d=e.format(b,this.setting.options.tipText);this.target.value(a);this.currentDate=b;this.currentDint=e.parseDateInt(b);
this.hide();var g=this,h=this.setting.listeners;h.onChange&&setTimeout(function(){h.onChange.call(g,c,d,!1)});this.target.trigger("change");var f=k(this.setting.options.nextEl);f.length&&setTimeout(function(){f[0].focus()});this.setting.options.showWeek&&this.setWeek();this.setting.options.showAlways&&this.update()},getWhatDay:function(a){var b=e.format(a);string=this.setting.string;if(b=this._checkFestival(b))return b[0].replace("c_","pic_");b=n;b=new Date(b.getFullYear(),b.getMonth(),b.getDate());
b=parseInt((a-b)/864E5,10);return (0<=b&&3>b?string.todayText[b]:string.weekText[a.getDay()])},setWeek:function(a){var b=null,b=(a?k(a):this.target);((a=b.value().toDate())?(a=this.getWhatDay(a))&&105<=b.offset().width&&b.css({"background-image":"url(http://pic.c-ctrip.com/cquery/"+a+".png)","background-position":"right center","background-repeat":"no-repeat"}):b.css({"background-image":"none"}))}};k.mod.reg({name:"calendar",version:"6.0",init:function(){},uninit:function(){},module:p})})(cQuery);
